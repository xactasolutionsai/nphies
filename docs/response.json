{
    "resourceType": "Bundle",
    "id": "9808942c-c2f6-4028-b723-3492a9554bcc",
    "meta": {
        "profile": [
            "http://nphies.sa/fhir/ksa/nphies-fs/StructureDefinition/bundle|1.0.0"
        ]
    },
    "type": "message",
    "timestamp": "2025-12-24T13:39:43.860+00:00",
    "entry": [
        {
            "fullUrl": "urn:uuid:6cba2417-10dc-4ed3-9e29-b7028084fbec",
            "resource": {
                "resourceType": "MessageHeader",
                "id": "6cba2417-10dc-4ed3-9e29-b7028084fbec",
                "meta": {
                    "profile": [
                        "http://nphies.sa/fhir/ksa/nphies-fs/StructureDefinition/message-header|1.0.0"
                    ]
                },
                "eventCoding": {
                    "system": "http://nphies.sa/terminology/CodeSystem/ksa-message-events",
                    "code": "status-response"
                },
                "destination": [
                    {
                        "endpoint": "http://provider.com",
                        "receiver": {
                            "type": "Organization",
                            "identifier": {
                                "system": "http://nphies.sa/license/provider-license",
                                "value": "1010613708"
                            }
                        }
                    }
                ],
                "sender": {
                    "type": "Organization",
                    "identifier": {
                        "system": "http://nphies.sa/license/nphies",
                        "value": "NPHIES"
                    }
                },
                "source": {
                    "endpoint": "http://nphies.sa/"
                },
                "response": {
                    "identifier": "6cba2417-10dc-4ed3-9e29-b7028084fbec",
                    "code": "fatal-error"
                },
                "focus": [
                    {
                        "reference": "http://provider.com/Task/1766583583860"
                    }
                ]
            }
        },
        {
            "fullUrl": "http://provider.com/Task/1766583583860",
            "resource": {
                "resourceType": "Task",
                "id": "1766583583860",
                "meta": {
                    "profile": [
                        "http://nphies.sa/fhir/ksa/nphies-fs/StructureDefinition/status-request|1.0.0"
                    ],
                    "tag": [
                        {
                            "code": "NPHIES generated",
                            "display": "NPHIES generated"
                        }
                    ]
                },
                "identifier": [
                    {
                        "system": "http://saudigeneralhospital.com.sa/identifiers/status-check",
                        "value": "status_1766583583860"
                    }
                ],
                "status": "failed",
                "intent": "order",
                "priority": "routine",
                "code": {
                    "coding": [
                        {
                            "system": "http://nphies.sa/terminology/CodeSystem/task-code",
                            "code": "poll",
                            "display": "Check status of the focal resource"
                        }
                    ]
                },
                "focus": {
                    "type": "Claim",
                    "identifier": {
                        "system": "http://saudigeneralhospital.com.sa/identifiers/claim",
                        "value": "CLM-1766573539986"
                    }
                },
                "authoredOn": "2025-12-24T13:39:43.860Z",
                "lastModified": "2025-12-24T13:39:43.860Z",
                "requester": {
                    "reference": "Organization/provider-org-1766583583860"
                },
                "owner": {
                    "reference": "Organization/insurer-org-1766583583860"
                },
                "output": [
                    {
                        "type": {
                            "coding": [
                                {
                                    "system": "http://nphies.sa/terminology/ValueSet/task-output-type",
                                    "code": "error"
                                }
                            ]
                        },
                        "valueCodeableConcept": {
                            "coding": [
                                {
                                    "extension": [
                                        {
                                            "url": "http://nphies.sa/fhir/ksa/nphies-fs/StructureDefinition/extension-error-expression",
                                            "valueString": "Bundle.entry[0].resource.response.code"
                                        }
                                    ],
                                    "system": "http://nphies.sa/terminology/CodeSystem/adjudication-error",
                                    "code": "IC-00224",
                                    "display": "MessageHeade response code is not provided"
                                }
                            ]
                        }
                    },
                    {
                        "type": {
                            "coding": [
                                {
                                    "system": "http://nphies.sa/terminology/ValueSet/task-output-type",
                                    "code": "error"
                                }
                            ]
                        },
                        "valueCodeableConcept": {
                            "coding": [
                                {
                                    "extension": [
                                        {
                                            "url": "http://nphies.sa/fhir/ksa/nphies-fs/StructureDefinition/extension-error-expression",
                                            "valueString": "Bundle.entry[0].resource.focus[0]"
                                        }
                                    ],
                                    "system": "http://nphies.sa/terminology/CodeSystem/adjudication-error",
                                    "code": "RE-00100",
                                    "display": "MessageHeader focus is not referring to a valid resource"
                                }
                            ]
                        }
                    },
                    {
                        "type": {
                            "coding": [
                                {
                                    "system": "http://nphies.sa/terminology/ValueSet/task-output-type",
                                    "code": "error"
                                }
                            ]
                        },
                        "valueCodeableConcept": {
                            "coding": [
                                {
                                    "extension": [
                                        {
                                            "url": "http://nphies.sa/fhir/ksa/nphies-fs/StructureDefinition/extension-error-expression",
                                            "valueString": "Bundle.entry[1].resource"
                                        }
                                    ],
                                    "system": "http://nphies.sa/terminology/CodeSystem/adjudication-error",
                                    "code": "RE-00170",
                                    "display": "Referenced SHALL point to a valid profile"
                                }
                            ]
                        }
                    },
                    {
                        "type": {
                            "coding": [
                                {
                                    "system": "http://nphies.sa/terminology/ValueSet/task-output-type",
                                    "code": "error"
                                }
                            ]
                        },
                        "valueCodeableConcept": {
                            "coding": [
                                {
                                    "extension": [
                                        {
                                            "url": "http://nphies.sa/fhir/ksa/nphies-fs/StructureDefinition/extension-error-expression",
                                            "valueString": "Bundle.entry[2].resource.extension"
                                        }
                                    ],
                                    "system": "http://nphies.sa/terminology/CodeSystem/adjudication-error",
                                    "code": "IC-01428",
                                    "display": "The element SHALL follow the cardinality specified in the NPHIES profile"
                                }
                            ]
                        }
                    },
                    {
                        "type": {
                            "coding": [
                                {
                                    "system": "http://nphies.sa/terminology/ValueSet/task-output-type",
                                    "code": "error"
                                }
                            ]
                        },
                        "valueCodeableConcept": {
                            "coding": [
                                {
                                    "extension": [
                                        {
                                            "url": "http://nphies.sa/fhir/ksa/nphies-fs/StructureDefinition/extension-error-expression",
                                            "valueString": "Bundle.entry[2].resource.extension[0].providerType"
                                        }
                                    ],
                                    "system": "http://nphies.sa/terminology/CodeSystem/adjudication-error",
                                    "code": "IC-01574",
                                    "display": "'Organization ProviderType' is not following the specified cardinality within the message profile"
                                }
                            ]
                        }
                    }
                ]
            }
        },
        {
            "fullUrl": "http://provider.com/Organization/provider-org-1766583583860",
            "resource": {
                "resourceType": "Organization",
                "id": "provider-org-1766583583860",
                "meta": {
                    "profile": [
                        "http://nphies.sa/fhir/ksa/nphies-fs/StructureDefinition/provider-organization|1.0.0"
                    ]
                },
                "identifier": [
                    {
                        "system": "http://nphies.sa/license/provider-license",
                        "value": "1010613708"
                    }
                ],
                "active": true,
                "type": [
                    {
                        "coding": [
                            {
                                "system": "http://nphies.sa/terminology/CodeSystem/organization-type",
                                "code": "prov"
                            }
                        ]
                    }
                ],
                "name": "Saudi General Hospital"
            }
        },
        {
            "fullUrl": "http://provider.com/Organization/insurer-org-1766583583860",
            "resource": {
                "resourceType": "Organization",
                "id": "insurer-org-1766583583860",
                "meta": {
                    "profile": [
                        "http://nphies.sa/fhir/ksa/nphies-fs/StructureDefinition/insurer-organization|1.0.0"
                    ]
                },
                "identifier": [
                    {
                        "use": "official",
                        "system": "http://nphies.sa/license/payer-license",
                        "value": "INS-FHIR"
                    }
                ],
                "active": true,
                "type": [
                    {
                        "coding": [
                            {
                                "system": "http://nphies.sa/terminology/CodeSystem/organization-type",
                                "code": "ins"
                            }
                        ]
                    }
                ],
                "name": "Saudi National Insurance"
            }
        }
    ]
}
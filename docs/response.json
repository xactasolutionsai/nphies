{
    "resourceType": "Bundle",
    "id": "9f781bc2-adce-4d81-a271-a061734b2678",
    "meta": {
        "profile": [
            "http://nphies.sa/fhir/ksa/nphies-fs/StructureDefinition/bundle|1.0.0"
        ]
    },
    "type": "message",
    "timestamp": "2025-12-22T15:52:41.068+03:00",
    "entry": [
        {
            "fullUrl": "http://nphies.sa/MessageHeader/bce332db-72a9-4618-8a41-3b8b10076c34",
            "resource": {
                "resourceType": "MessageHeader",
                "id": "bce332db-72a9-4618-8a41-3b8b10076c34",
                "meta": {
                    "profile": [
                        "http://nphies.sa/fhir/ksa/nphies-fs/StructureDefinition/message-header|1.0.0"
                    ]
                },
                "eventCoding": {
                    "system": "http://nphies.sa/terminology/CodeSystem/ksa-message-events",
                    "code": "poll-response"
                },
                "destination": [
                    {
                        "endpoint": "http://provider.com/fhir",
                        "receiver": {
                            "type": "Organization",
                            "identifier": {
                                "system": "http://nphies.sa/license/provider-license",
                                "value": "1010613708"
                            }
                        }
                    }
                ],
                "sender": {
                    "type": "Organization",
                    "identifier": {
                        "system": "http://nphies.sa/license/nphies",
                        "value": "NPHIES"
                    }
                },
                "source": {
                    "endpoint": "http://nphies.sa/"
                },
                "response": {
                    "identifier": "4c95dc23-287c-475c-81aa-96797c01c277",
                    "code": "fatal-error"
                }
            }
        },
        {
            "fullUrl": "http://nphies.sa/Task/f3d70925-81f3-4514-b56d-b26df6600181",
            "resource": {
                "resourceType": "Task",
                "id": "f3d70925-81f3-4514-b56d-b26df6600181",
                "meta": {
                    "profile": [
                        "http://nphies.sa/fhir/ksa/nphies-fs/StructureDefinition/poll-request|1.0.0"
                    ],
                    "tag": [
                        {
                            "code": "NPHIES generated",
                            "display": "NPHIES generated"
                        }
                    ]
                },
                "identifier": [
                    {
                        "system": "http://provider.com/fhir/identifiers/poll-request",
                        "value": "870"
                    }
                ],
                "status": "failed",
                "intent": "order",
                "code": {
                    "coding": [
                        {
                            "system": "http://nphies.sa/terminology/CodeSystem/task-code",
                            "code": "poll"
                        }
                    ]
                },
                "authoredOn": "2025-12-22T12:52:35.868Z",
                "requester": {
                    "reference": "urn:uuid:org-provider-001"
                },
                "owner": {
                    "identifier": {
                        "system": "http://nphies.sa/license/nphies",
                        "value": "NPHIES"
                    }
                },
                "output": [
                    {
                        "type": {
                            "coding": [
                                {
                                    "system": "http://nphies.sa/terminology/ValueSet/task-output-type",
                                    "code": "error"
                                }
                            ]
                        },
                        "valueCodeableConcept": {
                            "coding": [
                                {
                                    "extension": [
                                        {
                                            "url": "http://nphies.sa/fhir/ksa/nphies-fs/StructureDefinition/extension-error-expression",
                                            "valueString": "Bundle.entry[0].resource.focus[0]"
                                        }
                                    ],
                                    "system": "http://nphies.sa/terminology/CodeSystem/adjudication-error",
                                    "code": "RE-00100",
                                    "display": "MessageHeader focus is not referring to a valid resource"
                                }
                            ]
                        }
                    },
                    {
                        "type": {
                            "coding": [
                                {
                                    "system": "http://nphies.sa/terminology/ValueSet/task-output-type",
                                    "code": "error"
                                }
                            ]
                        },
                        "valueCodeableConcept": {
                            "coding": [
                                {
                                    "extension": [
                                        {
                                            "url": "http://nphies.sa/fhir/ksa/nphies-fs/StructureDefinition/extension-error-expression",
                                            "valueString": "Bundle.entry[1].resource"
                                        }
                                    ],
                                    "system": "http://nphies.sa/terminology/CodeSystem/adjudication-error",
                                    "code": "RE-00170",
                                    "display": "Referenced SHALL point to a valid profile"
                                }
                            ]
                        }
                    },
                    {
                        "type": {
                            "coding": [
                                {
                                    "system": "http://nphies.sa/terminology/ValueSet/task-output-type",
                                    "code": "error"
                                }
                            ]
                        },
                        "valueCodeableConcept": {
                            "coding": [
                                {
                                    "extension": [
                                        {
                                            "url": "http://nphies.sa/fhir/ksa/nphies-fs/StructureDefinition/extension-error-expression",
                                            "valueString": "Bundle.entry[2].resource.extension"
                                        }
                                    ],
                                    "system": "http://nphies.sa/terminology/CodeSystem/adjudication-error",
                                    "code": "IC-01428",
                                    "display": "The element SHALL follow the cardinality specified in the NPHIES profile"
                                }
                            ]
                        }
                    },
                    {
                        "type": {
                            "coding": [
                                {
                                    "system": "http://nphies.sa/terminology/ValueSet/task-output-type",
                                    "code": "error"
                                }
                            ]
                        },
                        "valueCodeableConcept": {
                            "coding": [
                                {
                                    "extension": [
                                        {
                                            "url": "http://nphies.sa/fhir/ksa/nphies-fs/StructureDefinition/extension-error-expression",
                                            "valueString": "Bundle.entry[2].resource.extension[0].providerType"
                                        }
                                    ],
                                    "system": "http://nphies.sa/terminology/CodeSystem/adjudication-error",
                                    "code": "IC-01574",
                                    "display": "'Organization ProviderType' is not following the specified cardinality within the message profile"
                                }
                            ]
                        }
                    }
                ]
            }
        },
        {
            "fullUrl": "urn:uuid:org-provider-001",
            "resource": {
                "resourceType": "Organization",
                "id": "provider-org-1766407955868",
                "meta": {
                    "profile": [
                        "http://nphies.sa/fhir/ksa/nphies-fs/StructureDefinition/provider-organization|1.0.0"
                    ]
                },
                "identifier": [
                    {
                        "system": "http://nphies.sa/license/provider-license",
                        "value": "1010613708"
                    }
                ],
                "active": true,
                "type": [
                    {
                        "coding": [
                            {
                                "system": "http://nphies.sa/terminology/CodeSystem/organization-type",
                                "code": "prov"
                            }
                        ]
                    }
                ],
                "name": "Saudi General Hospital"
            }
        },
        {
            "fullUrl": "urn:uuid:org-nphies",
            "resource": {
                "resourceType": "Organization",
                "id": "NPHIES",
                "meta": {
                    "profile": [
                        "http://nphies.sa/fhir/ksa/nphies-fs/StructureDefinition/organization|1.0.0"
                    ]
                },
                "identifier": [
                    {
                        "system": "http://nphies.sa/license/nphies",
                        "value": "NPHIES"
                    }
                ],
                "active": true,
                "name": "National Program for Health Information Exchange Services"
            }
        }
    ]
}